<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>REAL TREE GUY – Dashboard</title>
  <link rel="stylesheet" href="styles.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

  <header class="rtg-header">
    <h1 class="rtg-title">REAL TREE GUY</h1>
    <p class="rtg-subtitle">Modular Static OS for Tree Work</p>
  </header>

  <main class="tree-menu">
    <div class="tree">
      <div class="canopy"></div>
      <div class="trunk"></div>

      <div class="branch b1"><div class="branch-bar"></div><div class="branch-bush"></div><a href="modules/profile/profile.html" class="branch-btn">Profile</a></div>
      <div class="branch b2"><div class="branch-bar"></div><div class="branch-bush"></div><a href="modules/customers/customers.html" class="branch-btn">Customers & Jobs</a></div>
      <div class="branch b3"><div class="branch-bar"></div><div class="branch-bush"></div><a href="modules/measurement/measurement.html" class="branch-btn">Tree Measurement</a></div>
      <div class="branch b4"><div class="branch-bar"></div><div class="branch-bush"></div><a href="modules/contracts/contracts.html" class="branch-btn">Contracts</a></div>
      <div class="branch b5"><div class="branch-bar"></div><div class="branch-bush"></div><a href="modules/calendar/calendar.html" class="branch-btn">Calendar</a></div>
      <div class="branch b6"><div class="branch-bar"></div><div class="branch-bush"></div><a href="modules/flyers/flyers.html" class="branch-btn">Cards & Flyers</a></div>
      <div class="branch b7"><div class="branch-bar"></div><div class="branch-bush"></div><a href="modules/map/real-tree-map.html" class="branch-btn">Real Tree Map</a></div>
    </div>
  </main>

  <section class="card" style="max-width:1100px;margin:40px auto;padding:20px;">
    <h2 style="font-size:1.8rem;margin-bottom:10px;color:#caffca;">Real Tree Map Preview</h2>

    <div id="rtg-filters" style="margin-bottom:15px;display:flex;gap:10px;flex-wrap:wrap;">
      <button class="btn-ghost" data-type="Home Depot">Home Depot</button>
      <button class="btn-ghost" data-type="Lowe's">Lowe’s</button>
      <button class="btn-ghost" data-type="Ace Hardware">Ace Hardware</button>
      <button class="btn-ghost" data-type="sawmill">Sawmills</button>
      <button class="btn-ghost" data-type="wood dump site">Wood Dumps</button>
      <button class="btn-ghost" data-type="chainsaw repair shop">Chainsaw Repair</button>
      <button class="btn-ghost" data-type="woodworking supply store">Woodworking Stores</button>
      <button class="btn-ghost" data-type="gas station">Gas Stations</button>
    </div>

    <div style="width:100%;height:400px;border-radius:14px;overflow:hidden;border:2px solid #2e6b33;">
      <iframe
        id="rtgMap"
        width="100%"
        height="100%"
        style="border:0;"
        loading="lazy">
      </iframe>
    </div>

    <a href="modules/map/real-tree-map.html"
       class="btn-primary"
       style="margin-top:20px;display:inline-block;">
      Open Full Screen Real Tree Map
    </a>
  </section>

  <footer class="rtg-footer">
    <p>Real Tree Guy • Modular Static App</p>
  </footer>

  <script>
    const dashMap = document.getElementById("rtgMap");
    const dashFilterButtons = document.querySelectorAll("#rtg-filters button");

    function getLocationOnce(cb) {
      navigator.geolocation.getCurrentPosition(
        pos => cb(pos.coords.latitude, pos.coords.longitude),
        () => {
          dashMap.src = "https://www.google.com/maps?q=tree+service+supplies&output=embed";
        },
        { enableHighAccuracy: true, timeout: 8000, maximumAge: 0 }
      );
    }

    function getLocationTwice(cb) {
      getLocationOnce(() => {
        getLocationOnce((lat2, lng2) => cb(lat2, lng2));
      });
    }

    // Initial center: location twice, then center on user
    getLocationTwice((lat, lng) => {
      dashMap.src = `https://www.google.com/maps?q=${lat},${lng}&z=13&output=embed`;
    });

    // Filters: location twice, then query "TYPE near lat,lng"
    dashFilterButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const type = btn.dataset.type;

        getLocationTwice((lat, lng) => {
          const q = `${type} near ${lat},${lng}`;
          dashMap.src =
            `https://www.google.com/maps?q=${encodeURIComponent(q)}&z=13&output=embed`;
        });
      });
    });
  </script>

</body>
</html>
